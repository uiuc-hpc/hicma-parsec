1. Setting DPLASMA and PARSEC

git clone https://Qinglei_Cao@bitbucket.org/icldistcomp/dplasma.git
git resest --hard 2fbef5d868f51f08300231045f1310e469821bb0

rm -rf parsec
git clone https://Qinglei_Cao@bitbucket.org/icldistcomp/parsec.git
cd parsec

#Use this one, if deadlock, use MPI_THREAD_SERIALIZED instead
# https://bitbucket.org/icldistcomp/parsec/issues/228/deadlock
git reset --hard 42a44ebdc37ea789aff17ea5511ffb3a86a22fb8 

vi parsec/include/parsec/parsec_config_bottom.h
search PARSEC_KCYCLIC_WITH_VIEW and replace:

#define PARSEC_KCYCLIC_WITH_VIEW 1 

# Apply patch for parsec of new band distribution
git apply lorapo_parsec.patch (this patch is in lorapo repo)

cd .. &&  mkdir build && cd build

# On Sheheen II with Intel:
srun cmake .. -DCMAKE_Fortran_FLAGS="-nofor-main" -DDPLASMA_PRECISIONS="s;d" -DBUILD_SHARED_LIBS=ON -DPARSEC_WITH_HEADER_FILES=ON -DCMAKE_INSTALL_PREFIX=$PWD/install -DPARSEC_WITH_DEVEL_HEADERS=ON -DCMAKE_CXX_COMPILER=CC -DCMAKE_C_COMPILER=cc -DCMAKE_Fortran_COMPILER=ftn -DPARSEC_ATOMIC_USE_GCC_32_BUILTINS_EXITCODE=0 -DPARSEC_ATOMIC_USE_GCC_64_BUILTINS_EXITCODE=0 -DPARSEC_ATOMIC_USE_GCC_128_BUILTINS_EXITCODE=0 -DPARSEC_GPU_WITH_CUDA=OFF -DPARSEC_HAVE_CUDA=off -DCMAKE_BUILD_TYPE=Release -DBLA_VENDOR=Intel10_64lp_seq -DPARSEC_DIST_EAGER_LIMIT=0 -DPARSEC_DIST_SHORT_LIMIT=0 -DPARSEC_DIST_COLLECTIVES=OFF
make clean
srun make -j 10 install

# After DPLASMA installed
add #include "dplasma_complex.h" to src/cores/core_zblas.h

# Install stars-h
Follow instructions on "https://github.com/ecrc/stars-h"


git clone https://Qinglei_Cao@bitbucket.org/bosilca/lorapo.git
cd lorapo

cp make.inc_example make.inc
modiyf make.inc and compile-lorapo.sh

git checkout lei_2flow

# On Sheheen II
sbatch compile-lorapo.sh
